import mongoose from 'mongoose';

const vulnSourceSchema = new mongoose.Schema({
  type: {
    type: String,
    enum: ['gvm', 'wazuh', 'mixed'],
    required: true
  },
  gvmResultId: { type: String },
  wazuhAlertId: { type: String }
}, { _id: false });

const vulnerabilitySchema = new mongoose.Schema({
  VulnerabilityId: { type: String, required: true, unique: true },
  theHiveCaseId: { type: String, required: true },
  Title: { type: String, required: true },
  Description: { type: String, required: true },
  Severity: {
    type: String,
    enum: ['critical', 'high', 'medium', 'low', 'info'],
    required: true
  },
  CVE: { type: [String], default: [] },
  createdAt: { type: Date, default: Date.now },
  statusVuln: { type: Boolean, required: true },
  source: { type: vulnSourceSchema, required: true }
});

export default mongoose.model('Vulnerability', vulnerabilitySchema);
